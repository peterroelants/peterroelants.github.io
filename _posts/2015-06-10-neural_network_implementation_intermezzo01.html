--- 
layout: notebook_post
title: How to implement a neural network Intermezzo 1
---

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="How-to-implement-a-neural-network:-Intermezzo-1">How to implement a neural network: Intermezzo 1<a class="anchor-link" href="#How-to-implement-a-neural-network:-Intermezzo-1">&#182;</a></h1><p>This is the first intermezzo of a 4 (+2) parts tutorial on how to implement a simple neural network model. You can find the links to the rest of the tutorial here:</p>
<ul>
<li><a href="{% post_url 2015-06-10-neural_network_implementation_part01 %}">Part 1: Linear regression</a></li>
<li><a href="{% post_url 2015-06-10-neural_network_implementation_intermezzo01 %}">Intermezzo 1: Logistic classification function</a></li>
<li><a href="{% post_url 2015-06-10-neural_network_implementation_part02 %}">Part 2: Logistic regression (classification)</a></li>
<li><a href="{% post_url 2015-06-10-neural_network_implementation_part03 %}">Part 3: Hidden layer</a></li>
<li><a href="{% post_url 2015-06-10-neural_network_implementation_intermezzo02 %}">Intermezzo 2: Softmax classification function</a></li>
<li><a href="{% post_url 2015-06-10-neural_network_implementation_part04 %}">Part 4: Vectorization</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Logistic-classification-function">Logistic classification function<a class="anchor-link" href="#Logistic-classification-function">&#182;</a></h2><p>If we want to do classification with neural networks we want to output a probability distribution over the classes from the output targets $t$. For the classification of 2 classes $t=1$ or $t=0$ we can use the <a href="http://en.wikipedia.org/wiki/Logistic_function">logistic function</a> used in <a href="http://en.wikipedia.org/wiki/Logistic_regression">logistic regression</a>. For multiclass classification there exists an extension of this logistic function called the <a href="http://en.wikipedia.org/wiki/Softmax_function">softmax function</a> which is used in <a href="http://en.wikipedia.org/wiki/Multinomial_logistic_regression">multinomial logistic regression</a>. The following section will explain the logistic function and how to optimize it, the <a href="{% post_url 2015-06-10-neural_network_implementation_intermezzo02 %}">next intermezzo</a> will explain the softmax function and how to derive it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c"># Python imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span> <span class="c"># Matrix and vector computation package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>  <span class="c"># Plotting library</span>
<span class="c"># Allow matplotlib to plot inside this notebook</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Logistic-function">Logistic function<a class="anchor-link" href="#Logistic-function">&#182;</a></h2><p>The goal is to predict the target class $t$ from an input $z$. The probability $P(t=1 | z)$ that input $z$ is classified as class $t=1$ is represented by the output $y$ of the logistic function computed as $y = \sigma(z)$. $\sigma$ is the <a href="http://en.wikipedia.org/wiki/Logistic_function">logistic function</a> and is defined as:
$$ \sigma(z) = \frac{1}{1+e^{-z}} $$</p>
<p>This logistic function, implemented below as <code>logistic(z)</code>, maps the input $z$ to an output between $0$ and $1$ as is illustrated in the figure below.</p>
<p>We can write the probabilities that the class is $t=1$ or $t=0$ given input $z$ as:</p>
$$\begin{split}
P(t=1| z) & = \sigma(z) = \frac{1}{1+e^{-z}} \\
P(t=0| z) & = 1 - \sigma(z) = \frac{e^{-z}}{1+e^{-z}} 
\end{split}$$<p>Note that input $z$ to the logistic function corresponds to the log <a href="http://www.ats.ucla.edu/stat/mult_pkg/faq/general/odds_ratio.htm">odds ratio</a> of $P(t=1|z)$ over $P(t=0|z)$.</p>
$$\begin{split}
log \frac{P(t=1|z)}{P(t=0|z)} & = log \frac{\frac{1}{1+e^{-z}}}{\frac{e^{-z}}{1+e^{-z}}} = log \frac{1}{e^{-z}} \\
& = log(1) - log(e^{-z}) = z
\end{split}$$<p>This means that the logg odds ratio $log(P(t=1|z)/P(t=0|z))$ changes linearly with $z$. And if $z = x*w$ as in neural networks, this means that  the logg odds ratio changes linearly with the parameters $w$ and input samples $x$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c"># Define the logistic function</span>
<span class="k">def</span> <span class="nf">logistic</span><span class="p">(</span><span class="n">z</span><span class="p">):</span> <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>

<span class="c"># Plot the logistic function</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">logistic</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="s">&#39;b-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;$z$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;$\sigma(z)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;logistic function&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Derivative-of-the-logistic-function">Derivative of the logistic function<a class="anchor-link" href="#Derivative-of-the-logistic-function">&#182;</a></h3><p>Since neural networks typically use <a href="http://en.wikipedia.org/wiki/Gradient">gradient</a> based opimization techniques such as <a href="http://en.wikipedia.org/wiki/Gradient_descent">gradient descent</a> it is important to define the <a href="http://en.wikipedia.org/wiki/Derivative">derivative</a> of the output $y$ of the logistic function with respect to its input $z$. ${\partial y}/{\partial z}$ can be calculated as:</p>
$$\frac{\partial y}{\partial z} = \frac{\partial \sigma(z)}{\partial z} = \frac{\partial \frac{1}{1+e^{-z}}}{\partial z} = \frac{-1}{(1+e^{-z})^2} *e^{-z}*-1 = \frac{1}{1+e^{-z}} \frac{e^{-z}}{1+e^{-z}}$$<p>And since $1 - \sigma(z)) = 1 - {1}/(1+e^{-z}) = {e^{-z}}/(1+e^{-z})$ this can be rewritten as:</p>
$$\frac{\partial y}{\partial z} = \frac{1}{1+e^{-z}} \frac{e^{-z}}{1+e^{-z}} = \sigma(z) * (1- \sigma(z)) =  y (1-y)$$<p>This derivative is implemented as <code>logistic_derivative(z)</code> and is plotted below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c"># Define the logistic function</span>
<span class="k">def</span> <span class="nf">logistic_derivative</span><span class="p">(</span><span class="n">z</span><span class="p">):</span> <span class="k">return</span> <span class="n">logistic</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">logistic</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>

<span class="c"># Plot the logistic function</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">logistic_derivative</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="s">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;$z$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;$</span><span class="se">\\</span><span class="s">frac{</span><span class="se">\\</span><span class="s">partial </span><span class="se">\\</span><span class="s">sigma(z)}{</span><span class="se">\\</span><span class="s">partial z}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;derivative of the logistic function&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
QmCC
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Cross-entropy-cost-function-for-the-logistic-function">Cross-entropy cost function for the logistic function<a class="anchor-link" href="#Cross-entropy-cost-function-for-the-logistic-function">&#182;</a></h3><p>The output of the model $y = \sigma(z)$ can be interpreted as a probability $y$ that input $z$ belongs to one class $(t=1)$, or probability $1-y$ that $z$ belongs to the other class $(t=0)$ in a two class classification problem. We note this down as: $P(t=1| z) = \sigma(z) = y$.</p>
<p>The neural network model will be optimized by maximizing the <a href="http://en.wikipedia.org/wiki/Likelihood_function">likelihood</a> that a given set of parameters $\theta$ of the model can result in a prediction of the correct class of each input sample. The parameters $\theta$ transform each input sample $i$ into an input to the logistic function $z_{i}$. The likelihood maximization can be written as:</p>
$$\underset{\theta}{\text{argmax}}\; \mathcal{L}(\theta|t,z) = \underset{\theta}{\text{argmax}} \prod_{i=1}^{n} \mathcal{L}(\theta|t_i,z_i)$$<p>The likelihood $\mathcal{L}(\theta|t,z)$ can be rewritten as the <a href="http://en.wikipedia.org/wiki/Joint_probability_distribution">joint probability</a> of generating $t$ and $z$ given the parameters $\theta$: $P(t,z|\theta)$. Since $P(A,B) = P(A|B)*P(B)$ this can be written as:</p>
$$P(t,z|\theta) = P(t|z,\theta)P(z|\theta)$$<p>Since we are not interested in the probability of $z$ we can reduce this to: $\mathcal{L}(\theta|t,z) = P(t|z,\theta) = \prod_{i=1}^{n} P(t_i|z_i,\theta)$. 
Since $t_i$ is a <a href="http://en.wikipedia.org/wiki/Bernoulli_distribution">Bernoulli variable</a>, and the probability $P(t| z) = y$ is fixed for a given $\theta$ we can rewrite this as:</p>
$$\begin{split}
P(t|z) & = \prod_{i=1}^{n} P(t_i=1|z_i)^{t_i} * (1 - P(t_i=1|z_i))^{1-t_i} \\
& = \prod_{i=1}^{n} y_i^{t_i} * (1 - y_i)^{1-t_i} \end{split}$$<p>Since the logarithmic function is a monotone increasing function we can optimize the log-likelihood function $\underset{\theta}{\text{argmax}}\; log \mathcal{L}(\theta|t,z)$. This maximum will be the same as the maximum from the regular likelihood function. The log-likelihood function can be written as:</p>
$$\begin{split} log \mathcal{L}(\theta|t,z) & = log \prod_{i=1}^{n} y_i^{t_i} * (1 - y_i)^{1-t_i} \\
& = \sum_{i=1}^{n} t_i log(y_i) + (1-t_i) log(1 - y_i)
\end{split}$$<p>Minimizing the negative of this function (minimizing the negative log likelihood) corresponds to maximizing the likelihood. This error function $\xi(t,y)$ is typically known as the <a href="http://en.wikipedia.org/wiki/Cross_entropy">cross-entropy error function</a> (also known as log-loss):</p>
$$\begin{split}
\xi(t,y) & = - log \mathcal{L}(\theta|t,z) \\
& = - \sum_{i=1}^{n} \left[ t_i log(y_i) + (1-t_i)log(1-y_i) \right] \\
& = - \sum_{i=1}^{n} \left[ t_i log(\sigma(z) + (1-t_i)log(1-\sigma(z) \right]
\end{split}$$<p>This function looks complicated but besides the previous derivation there are a couple of intuitions why this function is used as a cost function for logistic regression. First of all it can be rewritten as:</p>
$$ \xi(t_i,y_i) = 
   \begin{cases}
   -log(y_i) & \text{if } t_i = 1 \\
   -log(1-y_i) & \text{if } t_i = 0
  \end{cases}$$<p>Which in the case of $t_i=1$ is $0$ if $y_i=1$ $(-log(1)=0)$ and goes to infinity as $y_i \rightarrow 0$ $(\underset{y \rightarrow 0}{\text{lim}}  -log(y) = +\infty)$. The reverse effect is happening if $t_i=0$.<br>
So what we end up with is a cost function that is $0$ if the probability to predict the correct class is $1$ and goes to infinity as the probability to predict the correct class goes to $0$.</p>
<p>Notice that the cost function $\xi(t,y)$ is equal to the negative <a href="http://en.wikipedia.org/wiki/Log_probability">log probability</a> that $z$ is classified as its correct class:<br>
$-log(P(t=1| z)) = -log(y)$,<br>
$-log(P(t=0| z)) = -log(1-y)$.</p>
<p>By minimizing the negative log probability, we will maximize the log probability. And since $t$ can only be $0$ or $1$, we can write $\xi(t,y)$ as:
$$ \xi(t,y) = -t * log(y) - (1-t) * log(1-y) $$</p>
<p>Which will give $\xi(t,y) = - \sum_{i=1}^{n} \left[ t_i log(y_i) + (1-t_i)log(1-y_i) \right]$ if we sum over all $n$ samples.</p>
<p>Another reason to use the cross-entropy function is that in simple logistic regression this results in a <a href="http://en.wikipedia.org/wiki/Convex_function">convex</a> cost function, of which the global minimum will be easy to find. Note that this is not necessarily the case anymore in multilayer neural networks.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Derivative-of-the-cross-entropy-cost-function-for-the-logistic-function">Derivative of the cross-entropy cost function for the logistic function<a class="anchor-link" href="#Derivative-of-the-cross-entropy-cost-function-for-the-logistic-function">&#182;</a></h4><p>The derivative ${\partial \xi}/{\partial y}$ of the cost function with respect to its input can be calculated as:</p>
$$\begin{split}
\frac{\partial \xi}{\partial y} & = \frac{\partial (-t * log(y) - (1-t)* log(1-y))}{\partial y} = \frac{\partial (-t * log(y))}{\partial y} +  \frac{\partial (- (1-t)*log(1-y))}{\partial y} \\
& = -\frac{t}{y} + \frac{1-t}{1-y} = \frac{y-t}{y(1-y)}
\end{split}$$<p>This derivative will give a nice formula if it is used to calculate the derivative of the cost function with respect to the inputs of the classifier ${\partial \xi}/{\partial z}$ since the derivative of the logistic function is ${\partial y}/{\partial z} =  y (1-y)$:</p>
$$\frac{\partial \xi}{\partial z} = \frac{\partial y}{\partial z} \frac{\partial \xi}{\partial y} = y (1-y) \frac{y-t}{y(1-y)} = y-t $$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This post is generated from an IPython notebook file. <a href="https://github.com/peterroelants/peterroelants.github.io/blob/master/notebooks/neural_net_implementation/neural_network_implementation_intermezzo01.ipynb">Link to the full IPython notebook file</a></p>

</div>
</div>
</div>
